#!/bin/bash
set -ex

# Build tinfoil-boot Go binary
cd "$SRCDIR/tinfoil-boot"

# Set Go cache directories to writable locations
export GOCACHE=/var/tmp/go-cache
export GOMODCACHE=/var/tmp/go-mod

# Build static binary (no CGO dependencies)
CGO_ENABLED=0 go build -ldflags="-s -w" -o "$DESTDIR/usr/local/bin/tinfoil-init" .

echo "Built tinfoil-boot successfully"

